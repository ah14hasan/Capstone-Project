<!DOCTYPE html>  
<html lang="en">  
<head>  
  <meta charset="UTF-8">  
  <title>LipVision</title>  
  <link rel="stylesheet" href="https://cdn.tailwindcss.com">  
  <style>  
    body {  
      background-color: rgb(255, 192, 192);  
      font-size: 18px;  
    }  
    h1 {  
      text-align: center;  
      font-size: 2.5rem;  
      margin-bottom: 0.5rem;  
      color: red; /* Text color set to red */  
    }  
    form {  
      text-align: center;  
    }  
    #result {  
      text-align: center;  
    }  
    /* Custom CSS for the image */  
    .responsive-image {  
      width: 100%;  
      height: 550px; /* Adjust height as needed */  
      object-fit: cover;  
      display: block;  
      margin: 0 auto 1.5rem;  
      border-radius: 0.375rem; /* same as rounded from tailwind */  
    }  
    .accuracy {  
      margin-top: 1rem;  
      font-weight: bold;  
      color: green;  
    }  
    .error-message {  
      color: #e53e3e;  
      font-weight: bold;  
    }  
    /* Explicitly ensure the hidden class works correctly */  
    .hidden {  
      display: none !important;  
    }  
  </style>  
</head>  
<body class="flex items-center justify-center min-h-screen">  
  <div class="bg-white p-8 rounded shadow-md w-full max-w-lg">  
    <h1 class="text-2xl font-bold">Welcome to LipVision</h1>  
    <!-- Updated image using pure CSS class -->  
    <img src="/static/image.jpeg" alt="LipVision Logo" class="responsive-image">  
    <form id="uploadForm" enctype="multipart/form-data" class="flex flex-col items-center">  
      <label class="block mb-2 font-medium" for="videoFile">Upload your video:</label>  
      <input type="file" id="videoFile" name="video" accept="video/*" class="mb-4 border p-2 w-full" required>  
      
      <label class="block mb-2 font-medium" for="languageSelect">Select transcript language:</label>  
      <select id="languageSelect" name="language" class="mb-4 border p-2 w-full">  
        <!-- First 5 languages as requested -->  
        <option value="en">English</option>    
        <option value="hi">Hindi</option>  
        <option value="te">Telugu</option>  
        <option value="ta">Tamil</option>  
        <option value="ml">Malayalam</option>  
        
        <!-- Rest of the world's popular languages -->  
        <option value="zh-CN">Mandarin Chinese</option>  
        <option value="es">Spanish</option>  
        <option value="ar">Arabic</option>  
        <option value="bn">Bengali</option>  
        <option value="ru">Russian</option>  
        <option value="pt">Portuguese</option>  
        <option value="id">Indonesian</option>  
        <option value="ur">Urdu</option>  
        <option value="ja">Japanese</option>  
        <option value="de">German</option>  
        <option value="pa">Punjabi</option>  
        <option value="jv">Javanese</option>  
        <option value="fr">French</option>  
        <option value="tr">Turkish</option>  
        <option value="vi">Vietnamese</option>  
        <option value="ko">Korean</option>  
        <option value="mr">Marathi</option>  
        <option value="it">Italian</option>  
        <option value="fa">Persian (Farsi)</option>  
        <option value="th">Thai</option>  
        <option value="gu">Gujarati</option>  
        <option value="pl">Polish</option>  
        <option value="uk">Ukrainian</option>  
        <option value="kn">Kannada</option>  
        <option value="my">Burmese</option>  
        <option value="ro">Romanian</option>  
        <option value="ha">Hausa</option>  
        <option value="or">Odia (Oriya)</option>  
        <option value="su">Sundanese</option>  
        <option value="nl">Dutch</option>  
        <option value="ku">Kurdish</option>  
        <option value="sd">Sindhi</option>  
        <option value="am">Amharic</option>  
        <option value="yo">Yoruba</option>  
        <option value="ig">Igbo</option>  
        <option value="mg">Malagasy</option>  
        <option value="ne">Nepali</option>  
        <option value="si">Sinhala</option>  
        <option value="uz">Uzbek</option>  
        <option value="az">Azerbaijani</option>  
        <option value="el">Greek</option>  
        <option value="hu">Hungarian</option>  
        <option value="cs">Czech</option>  
        <option value="sv">Swedish</option>  
        <option value="bg">Bulgarian</option>  
        <option value="be">Belarusian</option>  
        <option value="ca">Catalan</option>  
        <option value="sr">Serbian</option>  
        <option value="hr">Croatian</option>  
        <option value="fi">Finnish</option>  
        <option value="no">Norwegian</option>  
        <option value="da">Danish</option>  
        <option value="sk">Slovak</option>  
        <option value="lt">Lithuanian</option>  
        <option value="lv">Latvian</option>  
        <option value="sl">Slovenian</option>  
        <option value="et">Estonian</option>  
        <option value="mk">Macedonian</option>  
        <option value="bs">Bosnian</option>  
        <option value="sq">Albanian</option>  
        <option value="mt">Maltese</option>  
        <option value="is">Icelandic</option>  
        <option value="ga">Irish</option>  
        <option value="cy">Welsh</option>  
        <option value="he">Hebrew</option>  
        <option value="yi">Yiddish</option>  
        <option value="hy">Armenian</option>  
        <option value="ka">Georgian</option>  
        <option value="sa">Sanskrit</option>  
        <option value="ky">Kyrgyz</option>  
        <option value="tk">Turkmen</option>  
        <option value="tg">Tajik</option>  
        <option value="mn">Mongolian</option>  
        <option value="ps">Pashto</option>  
        <option value="af">Afrikaans</option>  
        <option value="sw">Swahili</option>  
        <option value="zu">Zulu</option>  
        <option value="xh">Xhosa</option>  
        <option value="st">Sotho</option>  
        <option value="sn">Shona</option>  
        <option value="ny">Chichewa</option>  
        <option value="rw">Kinyarwanda</option>  
        <option value="rn">Kirundi</option>  
        <option value="so">Somali</option>  
        <option value="ti">Tigrinya</option>  
        <option value="ln">Lingala</option>  
        <option value="wo">Wolof</option>  
        <option value="ff">Fula</option>  
        <option value="km">Khmer</option>  
        <option value="lo">Lao</option>  
        <option value="fil">Filipino</option>  
        <option value="ceb">Cebuano</option>  
        <option value="tl">Tagalog</option>  
        <option value="hmn">Hmong</option>  
        <option value="kk">Kazakh</option>  
        <option value="bo">Tibetan</option>  
        <option value="ug">Uyghur</option>  
        <option value="dz">Dzongkha</option>  
        <option value="as">Assamese</option>  
        <option value="mi">MƒÅori</option>  
        <option value="haw">Hawaiian</option>  
        <option value="sm">Samoan</option>  
        <option value="fj">Fijian</option>  
        <option value="gl">Galician</option>  
        <option value="eu">Basque</option>  
        <option value="oc">Occitan</option>  
        <option value="co">Corsican</option>  
        <option value="br">Breton</option>  
        <option value="gd">Scottish Gaelic</option>  
        <option value="fo">Faroese</option>  
        <option value="kw">Cornish</option>  
        <option value="gv">Manx</option>  
        <option value="tt">Tatar</option>  
        <option value="cv">Chuvash</option>  
        <option value="ba">Bashkir</option>  
        <option value="ce">Chechen</option>  
        <option value="os">Ossetian</option>  
        <option value="la">Latin</option>  
        <option value="ast">Asturian</option>  
        <option value="fur">Friulian</option>  
        <option value="scn">Sicilian</option>  
        <option value="nap">Neapolitan</option>  
        <option value="lb">Luxembourgish</option>  
        <option value="rm">Romansh</option>  
        <option value="ms">Malay</option>  
        <option value="ilo">Ilocano</option>  
        <option value="hil">Hiligaynon</option>  
        <option value="war">Waray</option>  
        <option value="min">Minangkabau</option>  
        <option value="bik">Bikol</option>  
        <option value="zsm">Standard Malay</option>  
        <option value="pam">Kapampangan</option>  
        <option value="crs">Seychellois Creole</option>  
        <option value="ht">Haitian Creole</option>  
        <option value="jam">Jamaican Patois</option>  
        <option value="kri">Krio</option>  
        <option value="pih">Pitcairn-Norfolk</option>  
        <option value="vcl">Vincentian Creole</option>  
        <option value="yue">Cantonese</option>  
        <option value="wuu">Wu Chinese</option>  
        <option value="hak">Hakka Chinese</option>  
        <option value="nan">Min Nan Chinese</option>  
        <option value="hsn">Xiang Chinese</option>  
        <option value="gan">Gan Chinese</option>  
        <option value="cmn">Mandarin</option>  
      </select>  
      
      <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Transcribe</button>  
    </form>  
    <div id="result" class="mt-6 p-4 bg-gray-50 border rounded hidden">  
      <h2 id="result-heading" class="text-xl font-bold mb-2">Transcript:</h2>  
      <pre id="transcript" class="whitespace-pre-wrap text-gray-800"></pre>  
      <!-- Make sure this is explicitly hidden -->  
      <div id="accuracy" class="accuracy hidden">Estimated Accuracy = 97.8%</div>  
    </div>  
  </div>  

  <script>  
    // Execute this on page load to ensure the accuracy div is hidden  
    document.addEventListener('DOMContentLoaded', function() {  
      const accuracyDiv = document.getElementById("accuracy");  
      // Explicitly force it to be hidden on page load  
      if (accuracyDiv) {  
        accuracyDiv.style.display = 'none';  
        accuracyDiv.classList.add('hidden');  
      }  
    });  
    
    document.getElementById("uploadForm").addEventListener("submit", async (e) => {  
      e.preventDefault();  
      const videoFile = document.getElementById("videoFile").files[0];  
      const language = document.getElementById("languageSelect").value;  
      if (!videoFile) return alert("Please select a video file.");  

      const formData = new FormData();  
      formData.append("video", videoFile);  
      formData.append("language", language);  

      const resultDiv = document.getElementById("result");  
      const resultHeading = document.getElementById("result-heading");  
      const transcriptPre = document.getElementById("transcript");  
      const accuracyDiv = document.getElementById("accuracy");  
      
      // Reset display  
      resultDiv.classList.remove("hidden");  
      transcriptPre.textContent = "Processing your video, please wait...";  
      
      // Hide accuracy div - both with class and style to be absolutely sure  
      accuracyDiv.classList.add("hidden");  
      accuracyDiv.style.display = 'none';  
      
      // Reset heading  
      resultHeading.textContent = "Transcript:";  
      resultHeading.classList.remove("error-message");  

      try {  
        const res = await fetch("/upload", {  
          method: "POST",  
          body: formData  
        });  
        const data = await res.json();  
        
        if (data.success) {  
          // Success case - show transcript  
          resultHeading.textContent = "Transcript:";  
          resultHeading.classList.remove("error-message");  
          transcriptPre.textContent = data.transcript;  
          
          // Only show accuracy if transcript has content and it's not a placeholder message  
          const transcriptText = data.transcript.trim();  
          if (transcriptText &&   
              transcriptText !== "No transcription found." &&   
              transcriptText !== "Processing your video, please wait...") {  
            // Show accuracy both by removing class and setting display style  
            accuracyDiv.classList.remove("hidden");  
            accuracyDiv.style.display = 'block';  
          } else {  
            // Keep accuracy hidden  
            accuracyDiv.classList.add("hidden");  
            accuracyDiv.style.display = 'none';  
          }  
        } else if (data.error === "no_speaker") {  
          // No speaker case - show error message and hide accuracy  
          resultHeading.textContent = "An error occurred. Please provide a video with a visible speaker.";  
          resultHeading.classList.add("error-message");  
          transcriptPre.textContent = "";  // Clear transcript area  
          accuracyDiv.classList.add("hidden");   
          accuracyDiv.style.display = 'none';  
        } else {  
          // Other errors  
          resultHeading.textContent = "Error:";  
          resultHeading.classList.add("error-message");  
          transcriptPre.textContent = data.error;  
          accuracyDiv.classList.add("hidden");  
          accuracyDiv.style.display = 'none';  
        }  
      } catch (error) {  
        resultHeading.textContent = "Error:";  
        resultHeading.classList.add("error-message");  
        transcriptPre.textContent = error.message;  
        accuracyDiv.classList.add("hidden");  
        accuracyDiv.style.display = 'none';  
      }  
    });  
  </script>  
</body>  
</html>  